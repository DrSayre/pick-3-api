SELECT numbers, count(*) AS quanity, max(drawing_date) AS last_draw FROM pick_threes WHERE drawing_date > NOW() - INTERVAL '1000 days' AND drawing_time_id IN (SELECT id FROM drawing_times WHERE name ilike 'evening') AND numbers in (SELECT numbers FROM (SELECT * FROM (SELECT numbers, count(*) AS quanity, max(drawing_date) AS last_draw FROM pick_threes GROUP BY numbers ORDER BY numbers) AS foo WHERE numbers NOT IN (SELECT numbers FROM pick_threes WHERE drawing_date > NOW() - INTERVAL '500 days')) AS numbers_due) GROUP BY numbers ORDER BY numbers;