SELECT * FROM (SELECT numbers, max(drawing_date) AS last_draw FROM pick_threes GROUP BY numbers) AS full_numbers_due WHERE last_draw < NOW() - INTERVAL '500 days' AND numbers NOT IN (SELECT numbers FROM (SELECT numbers, max(drawing_date) AS last_draw FROM pick_threes WHERE drawing_time_id IN (SELECT id FROM drawing_times WHERE name ilike 'evening') GROUP BY numbers) AS midday_numbers WHERE last_draw > NOW() - INTERVAL '1000 days') ORDER BY numbers;